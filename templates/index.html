<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Live Overlay</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        /* ============================================
           CONFIGURAﾃﾃ髭S DE ESTILO - AJUSTE AQUI!
           ============================================ */
        
        :root {
            /* TAMANHO DA IMAGEM DO AVATAR (em pixels) */
            --avatar-size: 300px;
            
            /* DURAﾃﾃグ DA ANIMAﾃﾃグ DE FADE-IN (em segundos) */
            --fade-duration: 0.8s;
            
            /* TEMPO QUE A IMAGEM FICA NA TELA (em milissegundos) */
            /* 5000ms = 5 segundos */
            --display-time: 5000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            /* Fundo transparente para overlay */
            background: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .container {
            text-align: center;
            padding: 20px;
        }

        .avatar-wrapper {
            opacity: 0;
            transform: scale(0.8);
            transition: opacity var(--fade-duration) ease-out, 
                        transform var(--fade-duration) ease-out;
        }

        .avatar-wrapper.visible {
            opacity: 1;
            transform: scale(1);
        }

        .avatar {
            /* TAMANHO DO AVATAR - usa a variﾃ｡vel CSS definida acima */
            width: var(--avatar-size);
            height: var(--avatar-size);
            border-radius: 50%;
            border: 4px solid #ff0050;
            box-shadow: 0 0 20px rgba(255, 0, 80, 0.5);
            object-fit: cover;
        }

        .username {
            margin-top: 15px;
            color: #ffffff;
            font-size: 1.2rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            /* Fundo semi-transparente para melhor legibilidade */
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .welcome-text {
            color: #00f2ea;
            font-size: 1.5rem;
            margin-top: 8px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 16px;
            border-radius: 15px;
        }

        .welcome-message {
            color: #ffffff;
            font-size: 1.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            background: linear-gradient(135deg, #ff0050, #00f2ea);
            padding: 12px 24px;
            border-radius: 25px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="avatar-wrapper" class="avatar-wrapper">
            <div class="welcome-message">Bem-vindo ﾃ live! 脂</div>
            <img id="avatar" class="avatar" src="" alt="Avatar">
            <div id="username" class="username"></div>
            <div class="welcome-text">acabou de entrar! 凋</div>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURAﾃﾃグ DO TEMPO DE EXIBIﾃﾃグ
        // ============================================
        // Tempo em milissegundos que a imagem fica visﾃｭvel
        // Altere este valor para ajustar a duraﾃｧﾃ｣o
        const DISPLAY_TIME = 5000; // 5 segundos

        // Conecta ao servidor Socket.IO
        // Tenta WebSocket primeiro, fallback para polling
        const socket = io(window.location.origin, {
            transports: ['websocket', 'polling'],
            reconnection: true,
            reconnectionAttempts: 10,
            reconnectionDelay: 1000
        });
        
        socket.on('connect_error', (error) => {
            console.log('Erro de conexﾃ｣o, tentando polling...', error);
        });

        const avatarWrapper = document.getElementById('avatar-wrapper');
        const avatarImg = document.getElementById('avatar');
        const usernameDiv = document.getElementById('username');

        let hideTimeout = null;
        let queue = [];
        let isShowing = false;

        function showNextViewer() {
            if (queue.length === 0) {
                isShowing = false;
                return;
            }
            
            isShowing = true;
            const data = queue.shift();
            
            avatarImg.src = data.avatar_url;
            usernameDiv.textContent = '@' + data.unique_id;
            avatarWrapper.classList.add('visible');

            setTimeout(function() {
                avatarWrapper.classList.remove('visible');
                setTimeout(showNextViewer, 500);
            }, DISPLAY_TIME);
        }

        // Escuta o evento 'join' quando alguﾃｩm entra na live
        socket.on('join', function(data) {
            console.log('Novo espectador:', data);
            queue.push({
                avatar_url: data.avatar || 'https://via.placeholder.com/300?text=側',
                unique_id: data.unique_id || data.nickname
            });
            
            if (!isShowing) {
                showNextViewer();
            }
        });

        // Escuta comentﾃ｡rios (opcional - para debug)
        socket.on('comment', function(data) {
            console.log('Comentﾃ｡rio:', data.nickname, '-', data.comment);
        });

        // Status de conexﾃ｣o com TikTok
        socket.on('status', function(data) {
            console.log('Status TikTok:', data.message);
        });

        // Log de conexﾃ｣o
        socket.on('connect', function() {
            console.log('Conectado ao servidor Socket.IO');
        });

        socket.on('disconnect', function() {
            console.log('Desconectado do servidor');
        });
    </script>
</body>
</html>